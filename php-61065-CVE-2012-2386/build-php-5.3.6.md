# download php
```
wget 'http://museum.php.net/php5/php-5.3.6.tar.gz'
```

# build php
```
patch -p1 < klee.patch
LLVM_COMPILER=clang LLVM_CC_NAME=clang-8 CC=wllvm ./configure --disable-all --disable-cgi --enable-debug --disable-inline-optimization --enable-phar
LLVM_COMPILER=clang LLVM_CC_NAME=clang-8 CC=wllvm make -j20
extract-bc sapi/cli/php
```
# run klee
## record
```
klee -solver-backend=stp -call-solver=false -env-file=php_env -use-forked-solver=false -output-source=false -write-kqueries -write-paths --libc=uclibc --posix-runtime -pathrec-entry-point="__klee_posix_wrapped_main" -ignore-posix-path=true -use-independent-solver=false -oob-check=false -allocate-determ ./php.bc poc.php poc.phar.tar
```
## replay
```
klee -solver-backend=stp -call-solver=false -output-stats=false -output-istats=false -use-forked-solver=false -output-source=false -write-kqueries -write-paths --libc=uclibc --posix-runtime -env-file=php_env -pathrec-entry-point="__klee_posix_wrapped_main" -ignore-posix-path=true -replay-path=klee-out-0/test000001.path -use-independent-solver=false -oob-check=true -allocate-determ ./php.bc poc.php poc.phar.tar -sym-file poc.php 110 -sym-file poc.phar.tar 4251
```
